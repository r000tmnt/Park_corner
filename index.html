<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">

    <link rel="stylesheet" href="css/all.min.css">
    <link rel="stylesheet" href="css/index.css">
    <link rel="icon" href="images/ParkCorner_icon.png">

    <!-- Vue3 CDN -->
    <!-- <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script> -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>

    <!-- Vue i18n -->
    <!-- <script src="https://unpkg.com/vue-i18n@9"></script>  -->
    <script src="https://cdn.jsdelivr.net/npm/vue-i18n@9.1.10/dist/vue-i18n.global.prod.js"></script> 

    <!-- Vuelidate -->
    <script src="https://cdn.jsdelivr.net/npm/vue-demi"></script>
    <script src="https://cdn.jsdelivr.net/npm/@vuelidate/core"></script>
    <script src="https://cdn.jsdelivr.net/npm/@vuelidate/validators"></script>

    <!-- axios -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <title>公園一角/Park Corner</title>
  </head>
  <body>

    <div id="app">

      <Navbar @change-lang="changeLocale"></Navbar>

      <Carousel></Carousel>

      <Services></Services>

      <Self-Introduction></Self-Introduction>

      <Commission-Detail></Commission-Detail>

      <Style-References :styles="styles"></Style-References>

      <Contact-Form :rules="rules"></Contact-Form>

      <Footer-Component></Footer-Component>

    </div>

    <!-- bootstrap 5 JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>

    <script type="module">
      const { createApp, ref } = Vue;
      const { createI18n } = VueI18n;
      const vuelidate = Vuelidate;
      const { required, helpers, email, maxLength, numeric, createI18nMessage  } = VuelidateValidators
      
      import language from './js/locale.js'
      import Navbar from './component/navbar.js'
      import Carousel from './component/carousel.js'
      import Services from './component/services.js'
      import SelfIntroduction from './component/selfIntroduction.js'
      import CommissionDetail from './component/commissionDetail.js'
      import StyleReferences from './component/styleReferences.js'
      import ContactForm from './component/contactForm.js'
      import FooterComponent from './component/footer.js'

      const i18n = createI18n({
        allowComposition: true,
        locale: 'zh_TW',
        fallbackLocale: 'zh_TW',
        messages: language
      })

      const withI18nMessage = createI18nMessage({ t: i18n.global.t.bind(i18n) })

      console.log(withI18nMessage)    

      // 表單驗證規則加上客製化的驗證訊息
      const rules = {
            name: { 
                required: withI18nMessage(required) 
            },
            tel: { 
                numeric: withI18nMessage(numeric), 
                maxLength: withI18nMessage(maxLength(12))
            },
            email: { 
                required: withI18nMessage(required),
                email: withI18nMessage(email) 
            },
            type: { 
                required: withI18nMessage(required)  
            },
            desc: { 
                required: withI18nMessage(required) 
            }
        } 

      const app = createApp({
        components: {
          Navbar,
          Carousel,
          Services,
          SelfIntroduction,
          CommissionDetail,
          StyleReferences,
          ContactForm,
          FooterComponent
        },        
        setup(){
          let { locale } = i18n.global

          const styles = { ...i18n.global.messages.eng.reference_styles }

          console.log(styles)
    
          const changeLocale = (v) => {
            // console.log(v)
            i18n.global.locale = v
          }

          return {
            changeLocale,
            styles,
            rules
          }
        }
      })

      app.use(i18n)
      app.use(vuelidate.default)

      app.mount('#app')
    </script>
  </body>
</html>