<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <link rel="stylesheet" href="css/all.min.css">
    <link rel="stylesheet" href="css/index.css">
    <link rel="icon" href="images/ParkCorner_icon.png">

    <!-- Vue3 CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <!-- Vue i18n -->
    <script src="https://unpkg.com/vue-i18n@9"></script> 

    <!-- Vuelidate -->
    <script src="https://cdn.jsdelivr.net/npm/vue-demi"></script>
    <script src="https://cdn.jsdelivr.net/npm/@vuelidate/core"></script>
    <script src="https://cdn.jsdelivr.net/npm/@vuelidate/validators"></script>

    <!-- axios -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <title>公園一角/Park Corner</title>
  </head>
  <body>

    <div id="app">

      <Navbar @change-lang="changeLocale"></Navbar>

      <Carousel></Carousel>

      <Services></Services>

      <Self-Introduction></Self-Introduction>

      <Commission-Detail></Commission-Detail>

      <Style-References :styles="styles"></Style-References>

      <Contact-Form :rules="rules"></Contact-Form>

      <Footer-Compoment></Footer-Compoment>

    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" ></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
    <!-- <script src="https://smtpjs.com/v3/smtp.js"></script> -->
    <!-- <script src="js/FormSubmit.js"></script> -->

    <script type="module">
      const { createApp, ref } = Vue;
      const { createI18n } = VueI18n;
      const vuelidate = Vuelidate;
      const { required, helpers, email, maxLength, numeric, createI18nMessage  } = VuelidateValidators
      
      import language from './js/locale.js'
      import Navbar from './component/navbar.js'
      import Carousel from './component/carousel.js'
      import Services from './component/services.js'
      import SelfIntroduction from './component/selfIntroduction.js'
      import CommissionDetail from './component/commissionDetail.js'
      import StyleReferences from './component/styleReferences.js'
      import ContactForm from './component/contactForm.js'
      import FooterCompoment from './component/footer.js'

      const i18n = createI18n({
        allowComposition: true,
        locale: 'zh_TW',
        fallbackLocale: 'zh_TW',
        messages: language
      })

      const withI18nMessage = createI18nMessage({ t: i18n.global.t.bind(i18n) })

      console.log(withI18nMessage)

      // 表單驗證規則加上客製化的驗證訊息
      const rules = {
          name: { 
              required: withI18nMessage(required) 
          },
          tel: { 
              numeric: withI18nMessage(numeric), 
              maxLength: withI18nMessage(maxLength(12))
          },
          email: { 
              required: withI18nMessage(required),
              email: withI18nMessage(email) 
          },
          type: { 
              required: withI18nMessage(required)  
          },
          desc: { 
              required: withI18nMessage(required) 
          }
      }      

      const app = createApp({
        components: {
          Navbar,
          Carousel,
          Services,
          SelfIntroduction,
          CommissionDetail,
          StyleReferences,
          ContactForm,
          FooterCompoment
        },        
        setup(){
          let { t, locale } = i18n.global

          const styles = { ...i18n.global.messages.eng.reference_styles }

          console.log(styles)
    
          const changeLocale = (v) => {
            // console.log(v)
            i18n.global.locale = v
          }

          return {
            changeLocale,
            styles,
            rules,
            t,
          }
        }
      })

      app.use(i18n)
      app.use(vuelidate.default)

      app.mount('#app')
    </script>
  </body>
</html>